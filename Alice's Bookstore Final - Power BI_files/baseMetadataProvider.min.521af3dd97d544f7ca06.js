var powerbi,__awaiter=this&&this.__awaiter||function(e,i,s,d){return new(s=s||Promise)(function(n,t){function a(e){try{o(d.next(e))}catch(e){t(e)}}function r(e){try{o(d.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,r)}o((d=d.apply(e,i||[])).next())})},__generator=this&&this.__generator||function(a,r){var o,i,s,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(o)throw new TypeError("Generator is already executing.");for(;d;)try{if(o=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return d.label++,{value:t[1],done:!1};case 5:d.label++,i=t[1],t=[0];continue;case 7:t=d.ops.pop(),d.trys.pop();continue;default:if(!(s=0<(s=d.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){d=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))d.label=t[1];else if(6===t[0]&&d.label<s[1])d.label=s[1],s=t;else{if(!(s&&d.label<s[2])){s[2]&&d.ops.pop(),d.trys.pop();continue}d.label=s[2],d.ops.push(t)}}t=r.call(a,d)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};function addOrUpdateQueryString(e,t,n){n=parseQueryString(n=void 0===n?window.location.search:n);return n[e]=t,rebuildQueryString(n)}function clearQueryString(e,t){t=parseQueryString(t=void 0===t?window.location.search:t);return delete t[e],rebuildQueryString(t)}function parseQueryString(e){var t={},e=e=void 0===e?window.location.search:e;if(e&&"?"===e.substr(0,1))for(var n=0,a=e.substr(1).split("&");n<a.length;n++){var r=a[n].split("="),o=r[0],r=r.slice(1).join("=");t[decodeURIComponent(o)]=decodeURIComponent(r)}return t}function rebuildQueryString(e){var t,n="",a=!0;for(t in e)a||(n+="&"),n+=encodeURIComponent(t)+"=",e[t]&&(n+=encodeURIComponent(e[t])),a=!1;return n=a?n:"?"+n}function setCookie(e,t,n,a,r){void 0===n&&(n="/"),void 0===a&&(a="none"),r||(r=new Date).setFullYear(r.getFullYear()+1),window&&window.document&&(window.document.cookie=e+" = "+t+";secure;path="+n+";expires="+r.toUTCString()+";samesite="+a)}function startBaseMetadataLogRequest(e,t,n){e={url:e,start:new Date,requestId:t};return window[n].push(e),e}function endBaseMetadataLogRequest(e,t,n,a,r,o,i){e.end=new Date,e.isError=t,e.code=n,e.errorMessage=a,e.parseStart=o,e.parseEnd=i,e.size=r}function getBaseMetadata(t){var n=window;return new Promise(function(e){n.clientAuthEnabled?n.signInPromise.then(function(){window.baseMetadataFromClient?getBaseMetadataInternal(!1,t).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)}):window.baseMetadataFromClient?getBaseMetadataInternal(!1,t).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)})}function getBaseMetadataInternal(P,q){var O=window;return new Promise(function(L,R){var e=window.clusterUri,e=("/"===e.substring(e.length-1)?e:e+"/")+"metadata/bootstrap/base",t=P?window.baseMetadataRetryRequestId:window.baseMetadataRequestId,A=startBaseMetadataLogRequest(e,t,"getBaseMetadataInfo");try{var M=new XMLHttpRequest;M.open("GET",e,!0),M.setRequestHeader("Accept","application/json"),M.setRequestHeader("Authorization","Bearer "+window.powerBIAccessToken),M.setRequestHeader("ActivityId",window.telemetrySessionId),M.setRequestHeader("RequestId",t),M.setRequestHeader("X-PowerBI-Auto-License-Info","AutoLicenseAssignmentSupported"),null!==window.aadConsistencyHeaderScenarioId&&""!==window.aadConsistencyHeaderScenarioId&&M.setRequestHeader("ConsistencyLevel","Organization;ScenarioId="+window.aadConsistencyHeaderScenarioId),null!==powerbi.getQueryStringValue("redirectedFromSignup")&&M.setRequestHeader("X-PowerBI-RedirectedFromSignup","true"),M.onreadystatechange=function(){return __awaiter(this,void 0,void 0,function(){var a,r,o,i,s,d,u,c,w,l,g,f,p,h,m,v,b,y,S,I,C=this;return __generator(this,function(e){switch(e.label){case 0:if(e.trys.push([0,11,,12]),M.readyState===XMLHttpRequest.DONE){if(a=M.status,r=M.getAllResponseHeaders(),!(200<=a&&a<300||304===a))return[3,1];d=new Date,g=JSON.parse(M.responseText),u=new Date,window.powerbi,window.featureSwitches=g.clientFeatureSwitches,window.placeExpAssignmentContextOnPage&&(window.expAssignmentContext=g.expAssignmentContext),g&&g.branding&&g.branding.config&&(o=JSON.parse(g.branding.config),i={},Object.keys(o).forEach(function(e){var t=e[0].toLowerCase()+e.substring(1);i[t]=o[e]}),g.branding.config=i),window.placeBrandingInfoOnPage&&(window.brandInfo=g.branding),window.placeAutoLicenseAssignmentStateOnPage&&(m=void 0,!r||-1===r.indexOf("x-powerbi-auto-license-info")&&-1===r.indexOf("X-PowerBI-Auto-License-Info")||(m=M.getResponseHeader("x-powerbi-auto-license-info")),s=!1,m&&m.toLowerCase()==="AutoLicenseAssignmentSucceeded".toLowerCase()&&(t=-1!==q.href.indexOf("/teams"),n=function(e){for(var t=0,n=["iphone","ipad","android"];t<n.length;t++){var a=n[t];if(e.toLowerCase().includes(a))return!0}return!1}(window.navigator.userAgent),t&&n&&(q.href="/TeamsMobileAutoLicense?originalUrl="+encodeURIComponent(q.href)),s=!0),x()&&(x().hasAutoAssignedLicense=s),window.hasAutoAssignedLicense=s),(s=g.userSettings.preferredLanguage)&&0<s.length?(setCookie("PreferredLanguage",s),s.toLowerCase()!==B().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(y=q.origin+q.pathname,S=addOrUpdateQueryString("language",s,q.search),q.href=y+S)):""===s&&(setCookie("PreferredLanguage",s),window.navigator)&&window.navigator.language&&window.navigator.language.toLowerCase()!==B().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(y=q.origin+q.pathname,S=addOrUpdateQueryString("language",window.navigator.language,q.search),q.href=y+S),endBaseMetadataLogRequest(A,!1,a.toString(),void 0,M.responseText.length,d,u),L(g)}return[3,10];case 1:if(!isCAEClaimChallenge(a,M)||!O.teamsCAE||"Teams"!==O.hostPlatformName&&!0!==O.inTeams)return[3,2];for(d=O.metaOSAccessTokenKeyPrefix+O.hostPlatformName+"_"+O.hostPlatformType,u=O.metaOSUserInfoKeyPrefix+O.hostPlatformName+"_"+O.hostPlatformType,c=0,w=[d,u];c<w.length;c++)l=w[c],window.localStorage.removeItem(l);return(g=new URL(q.href)).searchParams.append("TeamsCAEinWFE","true"),q.href="/teams/TeamsAuthentication?"+encodeURIComponent(g.toString()),[3,10];case 2:return(f="UserNotLicensed",p=void 0,!r||-1===r.indexOf("x-powerbi-error-info")&&-1===r.indexOf("X-PowerBI-Error-Info")||(p=M.getResponseHeader("x-powerbi-error-info")),0===a&&!p&&window.navigator&&(p="NavigatorOnLineProperty="+window.navigator.onLine),0===a||404===a||408===a||500<=a&&a<600)?P?[3,7]:0!==a?[3,3]:(setTimeout(function(){return __awaiter(C,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,getBaseMetadataInternal(!0,q)];case 1:return t=e.sent(),L(t),[3,3];case 2:return t=e.sent(),R(t),[3,3];case 3:return[2]}})})},1e3),[3,6]):[3,9];case 3:return e.trys.push([3,5,,6]),[4,getBaseMetadataInternal(!0,q)];case 4:return h=e.sent(),L(h),[3,6];case 5:return h=e.sent(),R(h),[3,6];case 6:return[3,8];case 7:endBaseMetadataLogRequest(A,!0,a.toString(),p,void 0,void 0,void 0),R(p),e.label=8;case 8:return[3,10];case 9:p&&p.toLowerCase()===f.toLowerCase()?(endBaseMetadataLogRequest(A,!0,a.toString(),p,void 0,void 0,void 0),m=void 0,(m=!r||-1===r.indexOf("x-powerbi-auto-license-info")&&-1===r.indexOf("X-PowerBI-Auto-License-Info")?m:M.getResponseHeader("x-powerbi-auto-license-info"))&&m.toLowerCase()==="AutoLicenseAssignmentDisabledByTenant".toLowerCase()?q.href="https://aka.ms/pbiAdHocSubscriptionNotAllowed":(v=window.staticPageRedirectInTeams,I=powerbi.getQueryStringValue("route"),b=-1!==q.href.indexOf("/teams/"),S=y=void 0,y=I&&0<I.length?(S=clearQueryString("route",q.search),q.origin+"/"+I):(S=q.search,q.origin+q.pathname),q.href=b&&v?"/StaticTeamsSignUp?originalUrl="+encodeURIComponent(q.href)+"&redirectUrl="+encodeURIComponent(y+S):"/SignupRedirect?ru="+y+S)):endBaseMetadataLogRequest(A,!0,a.toString(),p,void 0,void 0,void 0),R(p),e.label=10;case 10:return[3,12];case 11:return I=e.sent(),A.end||endBaseMetadataLogRequest(A,!0,a.toString(),I.message,void 0,void 0,void 0),R(I.message),[3,12];case 12:return[2]}var t,n})})},M.send()}catch(e){A.end||endBaseMetadataLogRequest(A,!0,"No status code",e.message,void 0,void 0,void 0),R(e.message)}function x(){return function(){var e=n();e.session||(e.session={});return e.session}().userInfo}function B(){return function(){var e=n();e.common||(e.common={});return e.common}().cultureInfo}function n(){return window.powerbi||(window.powerbi={}),window.powerbi}})}(powerbi||(powerbi={})).getQueryStringValue=function(e,t){for(var n=(t=t||window.location.search).substr(1).split("&"),a=0,r=n.length;a<r;++a){var o=n[a].split("=");if(o[0]===e)return decodeURIComponent(o[1])}return null};var baseMetadataWindow=window;function isCAEClaimChallenge(e,t){t=t.getResponseHeader("WWW-Authenticate");return 401===e&&(null==t?void 0:t.includes("error"))}baseMetadataWindow.getBaseMetadataInfo=[],baseMetadataWindow.deferBaseMetadataPromise?baseMetadataWindow.getBaseMetadata=getBaseMetadata:baseMetadataWindow.baseMetadataPromise=getBaseMetadata(window.location);