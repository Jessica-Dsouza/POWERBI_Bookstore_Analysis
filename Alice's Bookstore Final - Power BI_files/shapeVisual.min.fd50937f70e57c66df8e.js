"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['shapeVisual.min.js'] || (this.parseTimeMarkers['shapeVisual.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('shapeVisual.min.js');var es6,powerbi,__extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,a,s,l){return new(s=s||Promise)(function(o,t){function r(e){try{n(l.next(e))}catch(e){t(e)}}function i(e){try{n(l.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}n((l=l.apply(e,a||[])).next())})},__generator=this&&this.__generator||function(r,i){var n,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(o){return function(e){var t=[o,e];if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=i.call(r,l)}catch(e){t=[6,e],a=0}finally{n=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__spreadArray=this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var r,i=0,n=t.length;i<n;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};!function(e){((e=e.powerbi||(e.powerbi={})).visuals||(e.visuals={})).importShapeVisualModule=function(){}}(es6=es6||{}),define("ShapeVisual/shape",["require","exports","ShapeVisual/shapeConverterUtils","TileLibrary/index"],function(e,t,n,l){Object.defineProperty(t,"__esModule",{value:!0}),t.createShape=t.Shape=void 0;var i=powerbi.visuals,o=jsCommon.BrowserUtils,p=powerbi.visuals.builder,a=i.ColorHelper,r=jsCommon.CssConstants.createClassAndSelector,s=powerbi.data.createDisplayNameGetter,u=i.InteractivityUtils,h=i.ObjectEnumerationBuilder,c=i.shapeType.shape,d=powerbi.VisualDataChangeOperationKind,g=i.shapeInstanceId,f=i.shapeObjectNames,S=i.shapeObjectPropertyNames,b=i.shapeObjectProps,w=r("shapeVisual"),y=[g.default],m=(v.prototype.init=function(e){this.currentViewport=e.viewport,this.hostServices=e.host,this.elementSelection=d3.select(e.element.get(0)),this.style=e.style,this.shapeTile=new P(this.hostServices),this.featureSwitches=e.featureSwitches},v.prototype.update=function(e){this.currentViewport=e.viewport,e.dataViews&&0<e.dataViews.length&&e.operationKind!==d.None&&((e=e.dataViews[0]).metadata,e=e.metadata.objects,this.data=v.convert(e,this.style),(0,n.setShapeAriaMetadata)(this.data.tileProps.shape.default.tileShape,this.hostServices),this.render())},v.convert=function(e,t){var o=a.create(t),r=(0,n.getTextDefaults)(t,o),i=(0,n.convertRotation)(e),r=(0,l.convertText)(e,o,y,r,n.textProps,{default:{rotation:i.rotation+i.textRotation}});return{tileProps:{fill:(0,l.convertTileFill)(e,o,y,(0,n.getFillDefaults)(t),n.fillProps),outline:(0,l.convertTileOutline)(e,o,y,(0,n.getOutlineDefaults)(t)),shape:{default:(0,l.convertTileShapeWithoutInstances)(e,(0,n.getShapeDefaults)(),n.shapeProps,{rotation:i.rotation+i.shapeRotation})},shadow:(0,l.convertTileShadow)(e,o,y,(0,n.getShadowDefaults)()),glow:(0,l.convertTileGlow)(e,o,y,(0,n.getGlowDefaults)(t))},contentProps:{text:r},rotationProps:i}},v.prototype.enumerateObjectInstances=function(e){var t=this.data;if(!t)return[];var o=new h;switch(e.objectName){case f.fill:t.tileProps.shape.default.tileShape!==c.Line&&(0,l.enumerateFillProperties)(o,t.tileProps.fill,y,this.getInstanceDisplayName);break;case f.outline:(0,l.enumerateOutlineProperties)(o,t.tileProps.outline,y,this.getInstanceDisplayName);break;case f.text:(0,l.enumerateTextProperties)(o,t.contentProps.text,y,this.getInstanceDisplayName);break;case f.shape:(0,l.enumerateShapePropertiesInstance)(o,t.tileProps.shape.default,this.featureSwitches);break;case f.shadow:(0,l.enumerateShadowProperties)(o,t.tileProps.shadow,y,this.getInstanceDisplayName);break;case f.glow:(0,l.enumerateGlowProperties)(o,t.tileProps.glow,y,this.getInstanceDisplayName);break;case f.rotation:this.enumerateRotationProperties(o,t.rotationProps)}return o.complete()},v.prototype.enumerateRotationProperties=function(e,t){var o,r={unitSymbol:i.visualLocKeys.DegreeLocKey,numberRange:{min:0,max:360}};(o={})[S.rotation]=t.rotation,o[S.shapeRotation]=t.shapeRotation,o[S.textRotation]=t.textRotation,e.pushInstance({objectName:S.rotation,selector:null,properties:o,validValues:((t={})[S.shapeRotation]=r,t[S.textRotation]=r,t)})},v.prototype.getFormattingModel=function(){var e,t,o=this;return this.data?(t=null==(e=this.featureSwitches)?void 0:e.onObject,new p.FormattingModelBuilder(function(){return!t&&o.getShapeCard()},function(){return t&&o.getShapeStyleCard()},function(){return o.getRotationCard()},function(){return!t&&o.getStyleCard()},function(){return o.getVisualLinkPlaceholder()}).build()):{cards:[]}},v.prototype.getShapeCard=function(){var t=this,e=b.shape,o=new p.FormattingCardUidBuilder("shape"),r=[],i=(0,l.getShapeGroup)(this.data.tileProps.shape.default,this.hostServices,this.featureSwitches,void 0,o);return r.push(i),new p.FormattingCardBuilder(o,"Visual_Shape",[e.tileShape,e.roundEdge,b.shape.linecapType,e.arrowheadSize,e.arrowStemWidth,e.chevronAngle,e.isocelesTriangleTipPosition,e.parallelogramSlant,e.trapezoidSlant,e.hexagonSlant,e.octagonSnipSize,e.speechBubbleHeight,e.speechBubbleTailPosition,e.speechBubbleTailAngle,e.rectangleRoundedCurve,e.tabCutCornerSnipSizeTopRight,e.tabCutCornerSnipSizeTop,e.tabCutCornerSnipSizeBottom,e.tabRoundCornerTopRight,e.tabRoundCornerTop,e.tabRoundCornerBottom],function(e){return t.hostServices.getLocalizedString(e)}).withGroups(r).build()},v.prototype.getShapeStyleCard=function(){var t=this,e=b.fill,o=b.glow,r=b.outline,i=b.shadow,n=b.shape,a=b.text,s=new p.FormattingCardUidBuilder("shapeStyle"),n=new p.FormattingCardBuilder(s,"Visual_ShapeStyle",[n.tileShape,n.roundEdge,b.shape.linecapType,n.arrowheadSize,n.arrowStemWidth,n.chevronAngle,n.isocelesTriangleTipPosition,n.parallelogramSlant,n.trapezoidSlant,n.hexagonSlant,n.octagonSnipSize,n.speechBubbleHeight,n.speechBubbleTailPosition,n.speechBubbleTailAngle,n.rectangleRoundedCurve,n.tabCutCornerSnipSizeTopRight,n.tabCutCornerSnipSizeTop,n.tabCutCornerSnipSizeBottom,n.tabRoundCornerTopRight,n.tabRoundCornerTop,n.tabRoundCornerBottom,e.show,e.fillColor,e.transparency,r.show,r.lineColor,r.weight,r.transparency,a.show,a.fontColor,a.fontSize,a.bold,a.italic,a.underline,a.fontFamily,a.text,a.verticalAlignment,a.horizontalAlignment,a.leftMargin,a.rightMargin,a.topMargin,a.bottomMargin,i.show,i.color,i.transparency,i.shadowBlur,i.shadowPositionPreset,o.show,o.color,o.transparency,o.shadowBlur],function(e){return t.hostServices.getLocalizedString(e)}),e=y[0],r=__spreadArray([(0,l.getShapeGroup)(this.data.tileProps.shape.default,this.hostServices,this.featureSwitches,void 0,s)],this.getStyleGroups(e,s),!0);return n.withGroups(r),n.build()},v.prototype.getRotationCard=function(){function t(e){return o.hostServices.getLocalizedString(e)}var o=this,r=b.rotation,i=this.data.rotationProps;return new p.FormattingCardBuilder(new p.FormattingCardUidBuilder("rotation"),"Visual_BasicShape_Rotate",[r.angle,r.shapeAngle,r.textAngle],t).addGroup("default",function(e){e.addSimpleSlice("all",p.SliderBuilder.getRotationSliderBuilder({descriptor:__assign(__assign({},r.angle),{selector:null}),value:i.rotation,localize:t}).build(),function(e){return e.withCustomDisplayName("All")}).addSimpleSlice("shape",p.SliderBuilder.getRotationSliderBuilder({descriptor:__assign(__assign({},r.shapeAngle),{selector:null}),value:i.shapeRotation,localize:t}).build(),function(e){return e.withCustomDisplayName("Visual_Shape")}).addSimpleSlice("text",p.SliderBuilder.getRotationSliderBuilder({descriptor:__assign(__assign({},r.textAngle),{selector:null}),value:i.textRotation,localize:t}).build(),function(e){return e.withCustomDisplayName("Text")})}).build()},v.prototype.getStyleCard=function(){var t=this,e=b.fill,o=b.outline,r=b.text,i=b.shadow,n=b.glow,a=y[0],s=new p.FormattingCardUidBuilder("style");return new p.FormattingCardBuilder(s,"Style",[e.show,e.fillColor,e.transparency,o.show,o.lineColor,o.weight,o.transparency,r.show,r.fontColor,r.fontSize,r.bold,r.italic,r.underline,r.fontFamily,r.text,r.verticalAlignment,r.horizontalAlignment,r.leftMargin,r.rightMargin,r.topMargin,r.bottomMargin,i.show,i.color,i.transparency,i.shadowBlur,i.shadowPositionPreset,n.show,n.color,n.transparency,n.shadowBlur],function(e){return t.hostServices.getLocalizedString(e)}).withGroups(this.getStyleGroups(a,s)).build()},v.prototype.getVisualLinkPlaceholder=function(){return p.buildHostFormattingCardPlaceholder("actions")},v.prototype.getStyleGroups=function(e,t){var o=[],r=(0,l.getFillGroupByInstance)(!1,this.data.tileProps.fill,this.hostServices,e,t),r=(o.push(r),(0,l.getOutlineGroupByInstance)(this.data.tileProps.outline,this.hostServices,e,t)),r=(o.push(r),(0,l.getTextGroupByInstance)(this.data.contentProps.text,this.hostServices,e,t)),r=(o.push(r),(0,l.getShadowGroupByInstance)(this.data.tileProps.shadow,this.hostServices,e,t)),r=(o.push(r),(0,l.getGlowGroupByInstance)(this.data.tileProps.glow,this.hostServices,e,t));return o.push(r),o},v.prototype.getInstanceDisplayName=function(e){if(e===g.default)return s("DefaultState")},v.prototype.render=function(){this.shapeTile.contentProperties=this.data.contentProps;var e={element:this.elementSelection,properties:this.data.tileProps,width:this.currentViewport.width,height:this.currentViewport.height};this.shapeTile.update(e)},v);function v(){}t.Shape=m,t.createShape=function(){return new m};C=l.Tile,__extends(T,C),Object.defineProperty(T.prototype,"cursor",{get:function(){return this.hasVisualLink?"pointer":"inherit"},enumerable:!1,configurable:!0}),T.prototype.beforeRender=function(){var t;return __awaiter(this,void 0,powerbi.Promise,function(){return __generator(this,function(e){return this.hasVisualLink=null==(t=this.hostServices.getVisualLinkProperties())?void 0:t.hasVisualLink,[2]})})},T.prototype.afterRender=function(){return __awaiter(this,void 0,powerbi.Promise,function(){var t,o;return __generator(this,function(e){return t=this.contentProperties.text[this.state],o=this.getContentInscribedRectangle(t.rotation),this.element.classed(w.class,!0),l.TileLibraryContent.renderText(this.element,__assign(__assign({},t),{dimensions:o}),!0),[2]})})},T.prototype.onTileClick=function(){var e=d3.event,t={type:0,visualObjects:[{objectName:"shape",selectorsByColumn:{}}],isCtrlOrMetaKey:o.isCtrlOrMeta(e),isShiftKey:e.shiftKey,position:u.getPositionOfLastInputEvent()};this.hostServices.onSelecting(t),1===t.action&&e.stopPropagation()};var C,P=T;function T(e){var t=C.call(this)||this;return t.hostServices=e,t}}),define("ShapeVisual/shapeConverterUtils",["require","exports","TileLibrary/index"],function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.setShapeAriaMetadata=t.convertRotation=t.getTextDefaults=t.textProps=t.getGlowDefaults=t.getShadowDefaults=t.getShapeDefaults=t.shapeProps=t.getOutlineDefaults=t.getFillDefaults=t.fillProps=void 0;var r=powerbi.visuals,i=jsCommon.Color,n=r.ColorHelper,a=r.Font,s=r.Units.FontSize,l=r.shapeProps,p=r.shapeObjectPropertyNames,u=(t.fillProps={props:{fillTransparency:l.fill.transparency},colorProps:{fillColor:l.fill.fillColor}},t.getFillDefaults=function(e){return{default:{show:!0,fillColor:n.getDataColorByIndex(e,0,r.ForegroundColorName),fillTransparency:0,fillImage:void 0}}},t.getOutlineDefaults=function(e){return{default:{show:!0,outlineColor:i.shadeColor(n.getDataColorByIndex(e,0,r.ForegroundColorName),-.25),outlineWeight:1,outlineTransparency:0}}},t.shapeProps={props:{tileShape:l.shape.tileShape,shapeRounding:l.shape.roundEdge,linecapType:l.shape.linecapType,arrowheadSize:l.shape.arrowheadSize,arrowStemWidth:l.shape.arrowStemWidth,chevronAngle:l.shape.chevronAngle,isocelesTriangleTipPosition:l.shape.isocelesTriangleTipPosition,parallelogramSlant:l.shape.parallelogramSlant,trapezoidSlant:l.shape.trapezoidSlant,hexagonSlant:l.shape.hexagonSlant,octagonSnipSize:l.shape.octagonSnipSize,speechBubbleHeight:l.shape.speechBubbleHeight,speechBubbleTailPosition:l.shape.speechBubbleTailPosition,speechBubbleTailAngle:l.shape.speechBubbleTailAngle,rectangleRoundedCurve:l.shape.rectangleRoundedCurve,tabCutCornerSnipSizeTopRight:l.shape.tabCutCornerSnipSizeTopRight,tabCutCornerSnipSizeTop:l.shape.tabCutCornerSnipSizeTop,tabCutCornerSnipSizeBottom:l.shape.tabCutCornerSnipSizeBottom,tabRoundCornerTopRight:l.shape.tabRoundCornerTopRight,tabRoundCornerTop:l.shape.tabRoundCornerTop,tabRoundCornerBottom:l.shape.tabRoundCornerBottom}},t.getShapeDefaults=function(){return{tileShape:powerbi.visuals.shapeType.shape.Rectangle,rotation:0,shapeRounding:0,linecapType:"flat",arrowheadSize:50,arrowStemWidth:25,chevronAngle:90,isocelesTriangleTipPosition:50,parallelogramSlant:100/3,trapezoidSlant:40,hexagonSlant:200/3,octagonSnipSize:100/3,speechBubbleHeight:10,speechBubbleTailPosition:powerbi.visuals.SpeechBubbleTailPosition.BottomLeft,speechBubbleTailAngle:90,rectangleRoundedCurve:25,tabCutCornerSnipSizeTopRight:25,tabCutCornerSnipSizeTop:25,tabCutCornerSnipSizeBottom:0,tabRoundCornerTopRight:25,tabRoundCornerTop:25,tabRoundCornerBottom:0}},t.getShadowDefaults=function(){return{default:{show:!1,shadowColor:"#000",shadowTransparency:70,shadowBlur:20,shadowPositionPreset:"bottomRight",shadowAngle:45,shadowDistance:50}}},t.getGlowDefaults=function(e){return{default:{show:!1,glowColor:n.getDataColorByIndex(e,0,r.ForegroundColorName),glowTransparency:0,glowBlur:40}}},t.textProps={props:{text:l.text.text,verticalAlignment:l.text.verticalAlignment,horizontalAlignment:l.text.horizontalAlignment,rightMargin:l.text.rightMargin,leftMargin:l.text.leftMargin,topMargin:l.text.topMargin,bottomMargin:l.text.bottomMargin},fontProps:{fontProperties:{objectName:"text",propertyNames:{color:p.fontColor,family:p.fontFamily,size:p.fontSize,italic:p.italic,bold:p.bold,underline:p.underline}}}},t.getTextDefaults=function(e,t){return{default:{show:!1,text:"",verticalAlignment:r.verticalAlignment.middle,horizontalAlignment:r.horizontalAlignment.center,rightMargin:0,leftMargin:0,topMargin:0,bottomMargin:0,rotation:0,fontProperties:r.FontProperties.createFromObjectOrStyle(void 0,{color:p.fontColor,size:p.fontSize,family:p.fontFamily},t,e,"background",void 0,{color:n.getThemeColor(e,"background"),size:s.createFromPt(10),family:a.Family.regular.css},!0)}}},t.convertRotation=function(e){return __assign(__assign({},h),(0,o.getSettingProps)(e,u.props))},{props:{rotation:l.rotation.angle,shapeRotation:l.rotation.shapeAngle,textRotation:l.rotation.textAngle}}),h={rotation:0,shapeRotation:0,textRotation:0};t.setShapeAriaMetadata=function(t,e){var o,r=powerbi.visuals.shapeType.type.members().filter(function(e){return e.value===t});0<r.length&&(o=r[0].displayName),e.setAriaMetadata({subtitleDisplayNameGetter:o})}}),function(e){var t;(t=e.visuals||(e.visuals={})).initializeShapeVisualFactoryES6=function(){t.setCreateShapeVisual(function(){return es6.powerbi.visuals.importShapeVisualModule().then(function(e){return new e.Shape})})}}(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['shapeVisual.min.js'] || (this.parseTimeMarkers['shapeVisual.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
